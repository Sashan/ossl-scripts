<!DOCTYPE html>

<html>

<head>
<script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
<script>
    document.addEventListener("DOMContentLoaded", function(){
	var chart_opts = {
	    chart: { 
		height: 450,
		width: 900,
		type: 'line'
	    },
	    series: [{
		name: 'Memory Profile',
		data: [ {%- for i in mp.get_profile() -%} {{ i }} {%- if not loop.last -%}, {%- endif -%} {%- endfor -%} ]
	    }],
	    xaxis: {
		categories: [ {%- for i in mp.get_time_axis() -%} {{ i }} {%- if not loop.last -%}, {%- endif -%} {%- endfor -%} ],
		title: {
		    text: 'Elapsed time in uSecs'
		}
	    }
	}

	var chart = new ApexCharts(document.querySelector("#chart"), chart_opts);
	chart.render();
    });
</script>
<title> {{ title }} </title>
</head>

<body>
    <h1>{{ title }}</h1>
    <div id="chart"></div>

    <p>
    {{ mp.get_total_mem() }} bytes of memory allocated in {{ mp.get_total_allocs() }} operations.
    </p>
{% for leak in mp.leaks() %}
{% if loop.first %}
    <div id="leaks">
	<h1>{%- if leak_count == 1 -%} Leak found {%- else -%} {{ leak_count }} Leasks found {%- endif -%}, {{ lost_bytes }} B  got lost </h2>
	<p>
	<ul>
{% endif %}
	    <li>Leak {{ loop.index }} is {{ mp.get_leak_sz(leak) }} bytes long.
		<ul>{% for op in mp.get_chain(leak) %}
		    <li>{{ MR(op).get_operation() }}({{ MR(op).get_rsize() }}) at {{ mp.get_time(op) }}</li>
		    {% endfor %}
		</ul>
{% if loop.last %}
	</ul>
	</p>
    </div><!--- "leaks" --->
{% endif %}
{% endfor %}
</div>
</body>

</html>
